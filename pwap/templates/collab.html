{% extends 'base.html' %}

{% block title %}
Learner collaborative
{% endblock title %}

{% block content %}
<style type="text/css">nav { display: none; }</style>
<div class="panel panel-default">
  <div class="panel-heading" id="collab-heading">
    <h2 class="panel-title" id="collab-title">Collaborative styleguide generation</h2>
    <button type="button" class="btn btn-success" id="view-styleguide" data-toggle="modal" data-target="#styleguide-modal">View / approve styleguide</button>
  </div>

  <div class="panel-body">
    <div class="row">
      <div class="col-xs-3">
              <div class="alert alert-success alert-dismissible tutorial-step active" id="tutorial-step-intro" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Welcome!</strong> Your goal is to identify all the <a href="http://getbootstrap.com/">Bootstrap</a> elements in the mockup to the right.
                <br><br>
                Start by <strong>clicking</strong> and <strong>dragging</strong> a box around an element.
              </div>
              <div class="alert alert-success alert-dismissible tutorial-step" id="tutorial-step-tag" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Tag the element</strong> with a Bootstrap class name from the list below. You can give the element as many tags as you want. Click <strong>Save</strong> when you're done.
                <br><br>
                <strong>Hover</strong> over a class name to see a description and examples.
              </div>
              <div class="alert alert-success alert-dismissible tutorial-step" id="tutorial-step-draw" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                Great! Try tagging another element.
                <br><br>
                You can <strong>edit</strong> or <strong>delete</strong> an element by clicking on it.
              </div>
              <div class="alert alert-success alert-dismissible tutorial-step" id="tutorial-step-cover" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                Keep tagging elements until everything in the mockup has been tagged.
                <br><br>
                To check your work, click on a tag from the list and see if the highlighted elements match.
              </div>
              <div class="alert alert-success alert-dismissible tutorial-step" id="tutorial-step-aprove" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                When you're satisfied with all your tags, click the "View / approve styleguide" button. Check your work, looking for elements that are out of place. Once everything looks good, click "Approve".
              </div>
        <div class="panel-group" id="element-list" role="tablist" aria-multiselectable="true"></div>
      </div>
      <div class="col-xs-9">
<<<<<<< HEAD
        <div id="mockCanvas">
          <img id="mockImg" src="/static/img/horsedvm_mockup.png" style="display: none;">
=======
        <h4>Mockup</h4>
        <div id="mockCanvas" style="position: relative;">
          <img id="mockImg" src="{{ image }}" style="display: none;">
>>>>>>> pre final commit
        </div>
      </div>
    </div>
  </div>
</div>

<div id="newElementForm" class="panel panel-default" style="width: 400px; position: absolute; display: none;">
  <div class="panel-heading"><label class="control-label" for="newElementTag">Tag the Element</label></div>
  <div class="panel-body">
    <div class="row">
      <div class="col-sm-6">
        <ul class="list-group" id="newElementClasses"></ul>
      </div>
      <div class="col-sm-6" id="newElementSiblings"></div>
    </div>
    <div class="row">
      <div class="col-lg-12 text-right">
        <div class="btn btn-link" id="newElementDelete">Delete</div>
        <div class="btn btn-default" id="newElementCancel">Cancel</div>
        <div class="btn btn-primary" id="newElementSubmit">Save</div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="styleguide-modal" tabindex="-1" role="dialog" aria-labelledby="styleguideModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title" id="styleguideModalLabel">Styleguide</h3>
      </div>
      <div class="modal-body" id="styleguide-modal-body">
        <div id="styleguide-modal-help-message">
           <p>Here you can see all the components you've tagged organized by Bootstrap class.</p>
           <p>Check to make sure that elements tagged to the same class look the same. If any elements look out of place, go back to the editor to change their tag.</p>
           <p>Once you've covered the whole mockup and everything looks right, click "Approve" to finsih your work.</p>
        </div>
        <div id="styleguide-body">
          <div class="alert alert-warning alert-dismissible" id="styleguide-empty-message" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            Looks like you haven't tagged anything yet. Once you tag elements, the styleguide will automatically generate here.
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Keep tagging</button>
        <a href="collab/done" type="button" class="btn btn-success">Approve</a>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="intro-modal" tabindex="-1" role="dialog" aria-labelledby="introModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title" id="introModalLabel">Welcome!</h3>
      </div>
      <div class="modal-body" id="intro-modal-body">
        <div id="styleguide-body">
          <p>Welcome! On this page you'll see a mockup for a website that someone has designed.</p>
          <p>The goal is to identify all the different Bootstrap elements in the mockup. Don't worry - we'll help you get started.</p>
          <p>If you're stuck at all, check out the info box on the top left for hints.</p>
          <p>Thanks, and happy tagging!</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-success" data-dismiss="modal">Got it!</button>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block script %}
<script type="text/template" id="elementListPanelTemplate">
<% _.forEach(groups, function(items, title) { %>
<div class="panel panel-default">
  <div class="panel-heading toggle-collapse" role="tab">
    <h4 class="panel-title">
      <a href="#el<%= title.replace(/ /g,'') %>" class="collapsed" data-toggle="collapse" data-parent="#element-list" aria-expanded="false" aria-controls="el<%= title %>">
        <%= title %>
      </a>
    </h4>
  </div>
  <div id="el<%= title.replace(/ /g,'') %>" class="panel-collapse collapse" role="tabpanel">
    <div class="panel-body">
      <div class="list-group">
        <% _.forEach(items, function(item) { %>
        <a href="#" class="list-group-item popover-trigger" data-item="<%= item %>" data-trigger="hover" data-html="true"><%= item %> <span class="badge">0</span></a>
        <% }); %>
      </div>
    </div>
  </div>
</div>
<% }); %>

</script>
<script src="https://cdn.socket.io/socket.io-1.3.3.js"></script>
<script type="text/javascript">
  mockup = '{{ image_key }}';
  PWAP.rects = {};
  PWAP.state = [];
  jQuery(function() {
    PWAP.collab();
  });
</script>
{% endblock script %}